@model ECOM.Models.ProductDetailViewModel
<link rel="stylesheet" href="~/css/product.css">

<div>
    <p class="product-category">Ürün Kategorisi: <a class="product-category" href="#"><b>@Model.Product!.SupCategory.Name</b></a>  ><a class="product-category" href="#"><b>@Model.Product.SubCategory.Name</b></a></p><br>
    <!-- Ürün Başlık ve Resim Bölümü -->
    <div class="product-header">
        <div class="product-image">
            <img src="~/img/msi 100m.jpg" alt="msi">
        </div>
        <div class="product-info">
            <h1>@Model.Product.Name</h1>
            <div class="badge badge-success badge-pill bg-success">@Model.Product.Brand.Name</div>
            <div class="badge badge-success badge-pill bg-primary">@Model.Product.Seller.Name</div>
            <div class="product-price">₺@Model.Product.Price</div>
            <div class="forms">
                <form action="AddCart" method="post">
                    <input type="hidden" name="productId" value=@Model.Product.ProductId />
                    <input type="hidden" name="productName" value=@Model.Product.Name>
                    <input type="number" hidden name="price" value=@Model.Product.Price>
                    <button class="addCart"><b>Sepete Ekle</b></button>
                </form>
                <form action="Buy" method="post">
                    <input type="hidden" name="productId" value=@Model.Product.ProductId />
                    <input type="hidden" name="productName" value=@Model.Product.Name>
                    <input type="hidden" name="price" value=@Model.Product.Price>
                    <button class="buy"><b>Satın Al</b></button>
                </form>
            </div>
        </div>
    </div>

    <!-- Ürün Açıklaması Bölümü -->
    <div class="description">
        <div class="description-content">
            <h2>Ürün Açıklaması</h2>
            <p>
                @Model.Product.Description
            </p>
        </div>
    </div>

    <!-- Yorumlar ve Değerlendirmeler Bölümü -->
    <div class="review-section">
        <h3 class="review">Yorumlar (@Model.Comments.Count Yorum)</h3>
        @foreach (var comment in Model.Comments) // her bir yorum için döner
        {
            <div class="review">
                <div class="rating">
                    @for (int i = 0; i < 5; i++) // her bir yorumun skorunu ekrana basar
                    {
                        if (i < comment.Score)
                        {
                            @:&#9733;
                        }
                        else
                        {
                            @:&#9734;
                        }
                    }
                </div>
                <p><strong>@comment.Customer.Name @comment.Customer.Surname!.Substring(0, 1).</strong> - @comment.Score yıldız</p>
                <p>@comment.Comment</p>
            </div>
        }
        <br />
    </div>
    <br />

    <!-- Yorum Yapma Bölümü -->
    <div class="leave-review">
        <div class="write-comment">
            <h3 class="mt-3">Yorum Yapın</h3>
            <form asp-controller="Product" asp-action="SendComment" method="post">
                <label for="rating">Puanınızı Seçin:</label><br>
                <span class="rating">
                    <a href="javascript:void(0);" id="rate5" class="rating">&#9733;&#9733;&#9733;&#9733;&#9733;</a>
                    <a href="javascript:void(0);" id="rate4" class="rating">&#9733;&#9733;&#9733;&#9733;&#9734;</a>
                    <a href="javascript:void(0);" id="rate3" class="rating">&#9733;&#9733;&#9733;&#9734;&#9734;</a>
                    <a href="javascript:void(0);" id="rate2" class="rating">&#9733;&#9733;&#9734;&#9734;&#9734;</a>
                    <a href="javascript:void(0);" id="rate1" class="rating">&#9733;&#9734;&#9734;&#9734;&#9734;</a>
                </span><br><br>
                <input class="comment" type="text" hidden id="rate" name="rate">
                <textarea class="comment" id="review-text" name="comment" rows="5" cols="60"
                          placeholder="Yorumunuzu buraya yazın..."></textarea><br><br>
                <button class="send-comment" type="submit">
                    Yorum Gönder
                </button>
            </form>
        </div>
    </div>
    Comment: @ViewBag.Comment <br>
    Rate: @ViewBag.Rate <br>
    CommentInfo: @ViewBag.CommentInfo <br>
</div>

<script>
    // Rating yıldızlarına tıklama işlevini ekleyelim
    const ratingLinks = document.querySelectorAll('.rating');
    const rateInput = document.getElementById('rate');

    ratingLinks.forEach(link => {
        link.addEventListener('click', function () {
            // Tıklanan linkin id'sine göre input değerini ayarlıyoruz
            const ratingValue = this.id.replace('rate', '');
            rateInput.value = ratingValue;

            // Seçilen yıldızları görsel olarak değiştirebiliriz (altın renginde)
            ratingLinks.forEach(link => link.style.color = ''); // Tüm yıldızları sıfırla
            for (let i = 0; i < ratingValue; i++) {
                ratingLinks[i].style.color = 'gold'; // Seçilen yıldızları altın renginde yap
            }
        });
    });
</script>